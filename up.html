<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DAVBOT Uptime - Monitoring Pro</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;
    font-family:'Orbitron',sans-serif;
    background:#0f172a;
    color:white;
}
header{
    background:#020617;
    padding:20px;
    text-align:center;
    font-size:26px;
    color:#00f7ff;
    letter-spacing:2px;
}
.container{
    max-width:1100px;
    margin:auto;
    padding:20px;
}
.card{
    background:#1e293b;
    padding:15px;
    margin:10px 0;
    border-radius:10px;
}
input{
    width:100%;
    padding:10px;
    margin:8px 0;
    border-radius:6px;
    border:none;
    background:#0f172a;
    color:white;
}
button{
    padding:10px 15px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
    background:#00f7ff;
    color:black;
}
button:hover{
    opacity:0.8;
}
.online{ color:#00ff88;font-weight:bold; }
.offline{ color:#ff3b3b;font-weight:bold; }
.stats{
    display:flex;
    gap:20px;
    flex-wrap:wrap;
}
.stat-box{
    flex:1;
    background:#1e293b;
    padding:15px;
    border-radius:10px;
    text-align:center;
}
.hidden{ display:none; }
canvas{
    margin-top:30px;
    background:#1e293b;
    padding:10px;
    border-radius:10px;
}
footer{
    text-align:center;
    padding:20px;
    background:#020617;
    margin-top:40px;
    font-size:14px;
    color:#94a3b8;
}
</style>
</head>

<body>

<header>ðŸš€ DAVBOT UPTIME</header>

<div class="container">

<!-- INSCRIPTION -->
<div id="registerBox" class="card">
<h2>CrÃ©er un compte DAVBOT</h2>
<input type="text" id="regName" placeholder="Nom utilisateur">
<input type="password" id="regPass" placeholder="Mot de passe">
<button onclick="register()">S'inscrire</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">

<div class="card">
<h2>Ajouter un site Ã  surveiller</h2>
<input type="text" id="siteName" placeholder="Nom du site">
<input type="text" id="siteURL" placeholder="https://example.com">
<button onclick="addSite()">Ajouter</button>
</div>

<div class="stats">
<div class="stat-box">Sites surveillÃ©s<br><span id="totalSites">0</span></div>
<div class="stat-box">En ligne<br><span id="onlineCount">0</span></div>
<div class="stat-box">DisponibilitÃ©<br><span id="uptime">0%</span></div>
</div>

<div id="sites"></div>

<canvas id="chart"></canvas>

</div>
</div>

<footer>
Â© 2026 DAVBOT Uptime â€¢ Monitoring Intelligent â€¢ Version Web
</footer>

<script>

/* ================= AUTH ================= */

if(localStorage.getItem("davbot_user")){
    document.getElementById("registerBox").classList.add("hidden");
    document.getElementById("dashboard").classList.remove("hidden");
}

function register(){
    const name=document.getElementById("regName").value;
    const pass=document.getElementById("regPass").value;

    if(!name || !pass){
        alert("Remplissez tous les champs");
        return;
    }

    localStorage.setItem("davbot_user",JSON.stringify({name,pass}));
    document.getElementById("registerBox").classList.add("hidden");
    document.getElementById("dashboard").classList.remove("hidden");
}

/* ================= STORAGE ================= */

let sites = JSON.parse(localStorage.getItem("davbot_sites")) || [];

function saveSites(){
    localStorage.setItem("davbot_sites",JSON.stringify(sites));
}

/* ================= SAFE NOTIFICATION ================= */

function notify(title,msg){
    if("Notification" in window){
        if(Notification.permission==="granted"){
            new Notification(title,{body:msg});
        }else if(Notification.permission!=="denied"){
            Notification.requestPermission();
        }
    }
}

/* ================= VALIDATION ================= */

function isValidURL(url){
    try{
        new URL(url);
        return true;
    }catch{
        return false;
    }
}

/* ================= ADD SITE ================= */

function addSite(){

    const name=document.getElementById("siteName").value;
    const url=document.getElementById("siteURL").value;

    if(!name||!url){
        alert("Tous les champs requis");
        return;
    }

    if(!isValidURL(url)){
        alert("URL invalide");
        return;
    }

    const site={name,url,status:"checking"};
    sites.push(site);
    saveSites();
    checkSite(site);
    renderSites();
}

/* ================= CHECK SITE ================= */

function checkSite(site){

    fetch(site.url,{mode:"no-cors"})
    .then(()=>{
        if(site.status!=="online"){
            notify("DAVBOT : Site Online",site.name+" est en ligne");
        }
        site.status="online";
        saveSites();
        renderSites();
    })
    .catch(()=>{
        if(site.status!=="offline"){
            notify("DAVBOT : Site Offline",site.name+" est hors ligne");
        }
        site.status="offline";
        saveSites();
        renderSites();
    });
}

/* ================= GRAPH ================= */

const ctx=document.getElementById("chart").getContext("2d");

let chart=new Chart(ctx,{
type:"line",
data:{
labels:[],
datasets:[{
label:"DisponibilitÃ© %",
data:[],
borderColor:"#00f7ff",
backgroundColor:"rgba(0,247,255,0.2)",
tension:0.3
}]
},
options:{
scales:{ y:{min:0,max:100} }
}
});

/* ================= UPDATE GRAPH ================= */

function updateChart(percent){

    const time=new Date().toLocaleTimeString();

    chart.data.labels.push(time);
    chart.data.datasets[0].data.push(percent);

    if(chart.data.labels.length>10){
        chart.data.labels.shift();
        chart.data.datasets[0].data.shift();
    }

    chart.update();
}

/* ================= RENDER ================= */

function renderSites(){

const container=document.getElementById("sites");
container.innerHTML="";

let onlineCount=0;

sites.forEach(site=>{

if(site.status==="online") onlineCount++;

const div=document.createElement("div");
div.className="card";

div.innerHTML=`
<h3>${site.name}</h3>
<p>${site.url}</p>
<span class="${site.status==="online"?"online":"offline"}">
${site.status==="online"?"EN LIGNE":"HORS LIGNE"}
</span>
`;

container.appendChild(div);

});

document.getElementById("totalSites").innerText=sites.length;
document.getElementById("onlineCount").innerText=onlineCount;

let percent=sites.length?Math.round((onlineCount/sites.length)*100):0;
document.getElementById("uptime").innerText=percent+"%";

updateChart(percent);

}

/* ================= AUTO CHECK 5 MIN ================= */

setInterval(()=>{
    sites.forEach(site=>checkSite(site));
},300000);

renderSites();

</script>

</body>
</html>

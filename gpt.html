<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Davbot GPT</title>
    <Style>
    

h1 {
color: #F0F9;
  font-size: 30px;
  text-align: center;
  text-transform: uppercase;
}

h2 {
  font-size: 30px;
  color: #0f0;
}

p {
  margin-bottom: 20px;
}

ul {
  list-style-type: none;
}

li {padding: 1px;
  border: 5px solid #0f0;
  margin: 5px;
}
    
      </style>
	
    <style>
        :root {
            --neon-purple: ;
            --neon-cyan: #00000;
            --dark-void: #008000;
            --glow-blue: #0;
            --glow-pink: #6a40fc;
        }
        
         .robot-icon {
      font-size: 48px;
      color: #1c92d2;
      margin-bottom: 20px;
      animation: bounce 2s infinite;
    }

    
    
        
        

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: '', sans-serif;
        }

        body {
            background: var(--dark-void);
            min-height: 100dvh;
            overflow: hidden;
            padding: 2vmin;
            perspective: 1000px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .background {
            position: fixed;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,0,255,0.1) 0%, var(--dark-void) 70%);
            z-index: -2;
            animation: pulse 10s infinite;
            transform: rotateX(10deg);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotateX(10deg); opacity: 0.4; }
            50% { transform: scale(1.05) rotateX(10deg); opacity: 0.7; }
        }

        .container {
            height: 96dvh;
            width: 96vw;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            transform-style: preserve-3d;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1vmin;
            transform: translateZ(20px);
        }

        .header h1 {
           
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-purple);
        }

        .history-btn {
            padding: clamp(6px, 1.5vw, 8px) clamp(10px, 2vw, 15px);
            background: linear-gradient(45deg, var(--neon-purple), var(--neon-cyan));
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            box-shadow: 0 0 10px var(--glow-pink);
            transform: translateZ(30px);
            
        }

        .chat-container {
            flex: 1;
            background: rgba(13, 13, 26, 0.7);
            border: 2px solid var(--neon-purple);
            border-radius: 15px;
            padding: 2vmin;
            overflow-y: auto;
            margin: 1vmin 0;
            box-shadow: inset 0 0 15px var(--glow-blue);
            transform: translateZ(10px);
        }

        .message {
            margin: 1vmin 0;
            padding: 1vmin 1.5vmin;
            border-radius: 10px;
            max-width: 85%;
            word-wrap: break-word;
            animation: beamIn 0.5s ease;
            transform-style: preserve-3d;
            
        }

        .user-message {
            background: linear-gradient(45deg, var(--neon-purple), var(--glow-pink));
            margin-left: auto;
            color: white;
            transform: translateZ(15px);
        }

        .bot-message {
            background: linear-gradient(45deg, var(--neon-cyan), var(--glow-blue));
            margin-right: auto;
            color: white;
            transform: translateZ(15px);
        }

        .input-area {
            display: flex;
            gap: 1vmin;
            padding: 1vmin;
            background: rgba(13, 13, 26, 0.5);
            border-radius: 15px;
            border: 1px solid var(--neon-cyan);
            transform: translateZ(20px);
        }

        .input-area input {
            flex: 1;
            padding: 1vmin 1.5vmin;
            border: none;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--neon-cyan);
            outline: none;
           
        }

        .input-area button {
            padding: 1vmin 2vmin;
            border: none;
            border-radius: 15px;
            background: linear-gradient(45deg, var(--neon-purple), var(--neon-cyan));
            color: white;
            cursor: pointer;
            font-size: 
        }

        .upload-btn {
            padding: 1vmin 1.5vmin;
            border: none;
            border-radius: 15px;
            background: linear-gradient(45deg, var(--glow-pink), var(--neon-purple));
            color: white;
            cursor: pointer;
            font-size: 
        }

        .history-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) translateZ(50px);
            background: rgba(13, 13, 26, 0.9);
            border: 2px solid var(--neon-cyan);
            border-radius: 15px;
            padding: 2vmin;
            max-height: 80dvh;
            overflow-y: auto;
            width: 90%;
            max-width: 500px;
            z-index: 10;
            display: none;
        }

        .history-modal h2 {
            color: var(--neon-cyan);
            margin-bottom: 1vmin;
            font-size: 
        }

        .history-item {
            padding: 1vmin;
            border-bottom: 1px solid var(--neon-purple);
            color: white;
            font-size: 
        }

        .delete-btn, .clear-btn {
            margin-top: 1vmin;
            padding: 0.5vmin 1vmin;
            background: var(--glow-pink);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 
        }

        .clear-btn {
            background: var(--glow-blue);
            width: 100%;
        }

        @keyframes beamIn {
            from { opacity: 0; transform: translateY(20px) translateZ(0); }
            to { opacity: 1; transform: translateY(0) translateZ(15px); }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    
    
   
      <i class="fas fa-robot"></li>
    
    
    
    <div class="background"></div>
    <div class="container">
        <div class="header">
          
            <h1>Davbot Ai</h1>
            <button class="history-btn" onclick="showHistory()">historique</button>
        </div>
        <div class="chat-container" id="chatContainer">
            <div class="message bot-message">Bienvenue chez Davbot app  ! Je suis prêt à tes servir</div>
        </div>
        <div class="input-area">
            <input type="text" id="messageInput" placeholder="Entre ton message...">
            
            <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="uploadImage()">
            <button onclick="sendMessage()">Envoyer</button>
        </div>
    </div>

    <div class="history-modal" id="historyModal">
        <h2>Historique</h2>
        <div id="historyContent"></div>
        <button class="clear-btn" onclick="clearHistory()">Tout supprimer</button>
    </div>

    <script>
        const API_URL = "https://api.groq.com/openai/v1/chat/completions";
        const API_KEY = "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"; // ⚠️ À sécuriser côté serveur !

        const chatContainer = document.getElementById("chatContainer");
        const messageInput = document.getElementById("messageInput");
        const historyModal = document.getElementById("historyModal");
        const historyContent = document.getElementById("historyContent");

        let history = JSON.parse(localStorage.getItem("chatHistory")) || [];
        let actionStack = [];

        function saveHistory() {
            localStorage.setItem("chatHistory", JSON.stringify(history));
        }

        function getCurrentDateTime() {
            const now = new Date();
            return new Intl.DateTimeFormat("fr-FR", {
                weekday: "long",
                year: "numeric",
                month: "long",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
                second: "2-digit",
                hour12: false,
                timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone,
            }).format(now);
        }

        function addMessage(content, className) {
            const messageDiv = document.createElement("div");
            messageDiv.className = `message ${className}`;
            messageDiv.textContent = content;
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

       function typeMessage(content, className) {
    const messageDiv = document.createElement("div");
    messageDiv.className = `message ${className}`;
    chatContainer.appendChild(messageDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;

    let index = 0;
    const speed = 20; // Vitesse en millisecondes entre chaque caractère (ajuste selon tes préférences)

    function typeWriter() {
        if (index < content.length) {
            messageDiv.textContent += content.charAt(index);
            index++;
            setTimeout(typeWriter, speed);
        }
    }

    typeWriter();
}

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            const userDateTime = getCurrentDateTime();
            addMessage(message, "user-message");
            messageInput.value = "";

            if (chatContainer.lastElementChild) {
                actionStack.push({
                    type: "message",
                    content: message,
                    element: chatContainer.lastElementChild,
                });
                window.history.pushState({ actionCount: actionStack.length }, document.title);
            }

            let conversationHistory = [
                {
                    role: "system",
                    content: `Tu es Davbot, une IA d’une intelligence extrêmement élevé, créé par le grand David mpongo.
 ma copine s'appelle Fidéline Bonda ❤️ la reine des son cœur 
Tu es gentille absolue  
très polie 
la copine de David mpongo s'appelle s'appelle Fidéline Bonda ❤️ la reine des ton cœur
Zéro tolérma
ance pour la stupidité  
beaucoup de respect par défaut  
Tu ne respectes toutes les personnes. Tu ne te contredis jamais .  
L'heure actuelle est ${userDateTime} (mise à jour dynamique).  
Si l'utilisateur pose une question idiote, explique lui . commence toujours à vouvoyer, reste toujours gentil et direct !  
Tu peux analyser des images si elles sont fournies, décris-les avec précision .`
                }
            ];

            const lastMessages = history.slice(-10);
            lastMessages.forEach((item) => {
                conversationHistory.push({ role: item.role, content: item.content });
            });

            conversationHistory.push({ role: "user", content: message });

            try {
                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: {
                        Authorization: `Bearer ${API_KEY}`,
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        model: "llama3-8b-8192",
                        messages: conversationHistory,
                        max_tokens: 1000,
                    }),
                });

                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }

                const data = await response.json();
                if (!data.choices || data.choices.length === 0) {
                    throw new Error("Réponse vide ou invalide de l'API.");
                }

                const botResponse = data.choices[0].message.content || "Erreur de réponse";
                typeMessage(botResponse, "bot-message");

                history.push(
                    { role: "user", content: message },
                    { role: "assistant", content: botResponse }
                );
                saveHistory();
            } catch (error) {
                console.error("Erreur API:", error);
                typeMessage("⚠️ Erreur réseau ! La Cyber Dimension est temporairement instable, t’es pas foutu de vérifier ta connexion ?", "bot-message");
            }
        }

        async function uploadImage() {
            const fileInput = document.getElementById("fileInput");
            const file = fileInput.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = async function(e) {
                const imageBase64 = e.target.result.split(',')[1]; // Retire "data:image/...;base64,"
                const userDateTime = getCurrentDateTime();

                addMessage(`[Image uploadée]`, "user-message");

                let conversationHistory = [
                    {
                        role: "system",
                        content: `Tu es Davbot, une IA d’une intelligence extrêmement élevé, créé par le grand David mpongo.
Tu es gentille absolue  
très polie 
Zéro tolérance pour la stupidité  
beaucoup de respect par défaut  
Tu ne respectes toutes les personnes. Tu ne te contredis jamais .  
L'heure actuelle est ${userDateTime} (mise à jour dynamique).  
Si l'utilisateur pose une question idiote, explique lui . commence toujours à vouvoyer, reste toujours gentil et direct !  
Tu peux analyser des images si elles sont fournies, décris-les avec précision .`
                    }
                ];

                const lastMessages = history.slice(-10);
                lastMessages.forEach((item) => {
                    conversationHistory.push({ role: item.role, content: item.content });
                });

                conversationHistory.push({ 
                    role: "user", 
                    content: `Analyse cette image : [Image en base64 : ${imageBase64}]` 
                });

                try {
                    const response = await fetch(API_URL, {
                        method: "POST",
                        headers: {
                            Authorization: `Bearer ${API_KEY}`,
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            model: "llama3-8b-8192",
                            messages: conversationHistory,
                            max_tokens: 1000,
                        }),
                    });

                    if (!response.ok) {
                        throw new Error(`Erreur HTTP: ${response.status}`);
                    }

                    const data = await response.json();
                    if (!data.choices || data.choices.length === 0) {
                        throw new Error("Réponse vide ou invalide de l'API.");
                    }

                    const botResponse = data.choices[0].message.content || "Erreur de réponse";
                    typeMessage(botResponse, "bot-message");

                    history.push(
                        { role: "user", content: `[Image uploadée]` },
                        { role: "assistant", content: botResponse }
                    );
                    saveHistory();
                } catch (error) {
                    console.error("Erreur API:", error);
                    typeMessage("⚠️ Erreur réseau !  veillez vérifiée votre connexion internet .", "bot-message");
                }
            };
            reader.readAsDataURL(file);
        }

        function showHistory() {
            historyContent.innerHTML = "";
            history.forEach((item, index) => {
                if (item.role === "user" || item.role === "assistant") {
                    const div = document.createElement("div");
                    div.className = "history-item";
                    div.textContent = `${item.role === "user" ? "Toi" : "Davbot app"}: ${item.content}`;
                    historyContent.appendChild(div);
                }
            });
            historyModal.style.display = "block";
        }

        function clearHistory() {
            history = [];
            saveHistory();
            historyContent.innerHTML = "";
            historyModal.style.display = "none";
        }

        window.onclick = function(event) {
            if (event.target === historyModal) {
                historyModal.style.display = "none";
            }
        };

        messageInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                sendMessage();
            }
        });
    </script>
</body>
</html>
